<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/img/钢铁侠.png?v=5.1.0" />






<meta name="description" content="Fire proves gold,adversity proves men.">
<meta property="og:type" content="website">
<meta property="og:title" content="RamboLu Blog">
<meta property="og:url" content="http://RamboLu.top/index.html">
<meta property="og:site_name" content="RamboLu Blog">
<meta property="og:description" content="Fire proves gold,adversity proves men.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RamboLu Blog">
<meta name="twitter:description" content="Fire proves gold,adversity proves men.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://RamboLu.top/"/>





  <title> RamboLu Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?2d9c1db15b7380e5a1acdc3b72311996";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <script type="text/javascript">
    (function() {
      var hm = document.createElement("script");
      hm.src = "//tajs.qq.com/stats?sId=61220060";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RamboLu Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            所有文章
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于我
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://RamboLu.top/2017/03/03/ReactNative学习-什么是iflux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RamboLu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/钢铁侠.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RamboLu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/03/ReactNative学习-什么是iflux/" itemprop="url">
                  ReactNative学习-什么是iflux?
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-03T20:44:29+08:00">
                2017-03-03
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/03/03/ReactNative学习-什么是iflux/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/03/03/ReactNative学习-什么是iflux/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/03/03/ReactNative学习-什么是iflux/" class="leancloud_visitors" data-flag-title="ReactNative学习-什么是iflux?">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="什么是iflux"><a href="#什么是iflux" class="headerlink" title="什么是iflux ?"></a>什么是iflux ?</h3><p><em>iflux = immutable.js + react.js</em></p>
<p><a href="https://nodei.co/npm/iflux/" target="_blank" rel="external"><img src="https://nodei.co/npm/iflux.png?downloads=true&amp;downloadRank=true&amp;stars=true" alt="NPM"></a></p>
<h3 id="什么是React-js"><a href="#什么是React-js" class="headerlink" title="什么是React.js ?"></a>什么是React.js ?</h3><p><a href="http://facebook.github.io/react/" target="_blank" rel="external">React.js</a>犹如Facebook的文化基因所强调的一样move fast and break things, 在快速前进中打破了很多我们对于web开发的固有认识。<br>更厉害的是React把这种创新平移到移动开发(React native)实现了Learn once, Write everywhere.</p>
<h3 id="React的特点。"><a href="#React的特点。" class="headerlink" title="React的特点。"></a>React的特点。</h3><ol>
<li><p>强调组件化的开发方式（更高的抽象层次，更好的分离关注点）</p>
</li>
<li><p>声明式的开发风格（更好的表现力）</p>
</li>
<li><p>单向的数据流动（简单可预测）</p>
</li>
<li><p>超高性能的渲染60fps不是梦 （掌声在哪里？）</p>
</li>
<li><p>最大的创新源于virtual dom （以及virtual native）</p>
</li>
<li><p>轻量，可以在现有的系统中快速试错</p>
</li>
<li><p>精确的生命周期，更简单的整合第三方的库(jquery)</p>
</li>
</ol>
<h3 id="关于更多"><a href="#关于更多" class="headerlink" title="关于更多"></a>关于更多</h3><p>因为React的定位就是轻量级高效组件式的view library，但是在我们实际的应用开发工程中不仅仅需要处理view的问题，更复杂的是对于状态的控制。<br>官方的<a href="https://facebook.github.io/flux/docs/overview.html" target="_blank" rel="external">flux</a>架构提供了一个很好的针对React的架构指导，但是代码量很大。<br>说到底flux就是在解决一个数据流向以及控制状态变化问题。这点om确实做的非常出色，<br>借助于Clojure的数据的特性（1. 数据不可变 2. 持久化数据结构 3.共享数据结构）在不断的追寻下，immutable.js出现在了眼前，如获至宝。<br>随着对immutable.js深入挖掘，发现正好契合了React的架构特点，可以使用Immutable很好的管理我们的Store，因为Immutable强调值语义，<br>能够更好的追踪状态的变化(cursor)且带来了更好的性能。</p>
<h3 id="整体思路"><a href="#整体思路" class="headerlink" title="整体思路"></a>整体思路</h3><ul>
<li>建议：优先选择connectToStore </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">+-----------------------+</div><div class="line">|       WebApi          |</div><div class="line">+-----------------------+</div><div class="line">          |  </div><div class="line">         \|/</div><div class="line">+-----------------------+</div><div class="line">|   Store（immutable）   |&lt;-----+</div><div class="line">+-----------------------+      |</div><div class="line">           | //es5的风格        |</div><div class="line">           | StoreMixin        | msg(EventEmitter)</div><div class="line">          \|/                  |</div><div class="line">+------------------------+     |</div><div class="line">|     React App          |-----|</div><div class="line">+------------------------+</div><div class="line">|      &lt;Layout&gt;          |</div><div class="line">|        &lt;SearchForm/&gt;   |</div><div class="line">|        &lt;Toolbar/&gt;      |</div><div class="line">|        &lt;DataGrid/&gt;     |</div><div class="line">|       &lt;/Layout&gt;        |</div><div class="line">+------------------------+</div></pre></td></tr></table></figure>
<p>一个应用只有一个Store，单根数据源，单向数据流动，数据沉淀在顶层。<br>且通过PureRenderMix可以获取更好的性能。简直就是为React私人定制一般。</p>
<p>于是，顺其自然的写了iflux去更好的粘合React和immutable。</p>
<p>整体思路：</p>
<ol>
<li><p>React只承担view应该承担的事情（1. 资料呈现 2. 用户交互） 不处理任何的业务逻辑，就是根据数据去渲染dom即可，这样view可以做的很轻。</p>
</li>
<li><p>应用的全部数据沉淀在一个Store中，当全部数据在顶层时，很多事情都变得简单，因为获取数据变得十分廉价。无论是校验和对数据的转换控制都变得非常简单。</p>
</li>
<li><p>React只是取数据渲染，其他的比如状态的变化全部通过事件pubsub通知appstore去更新数据。如果状态不会影响其他组件的级联变化可以放在组件内部消化掉。</p>
</li>
<li><p>所有的ajax封装在webapi模块中，全部promise化。回调回来通过cursor更新store, cursor更新store， store通知React去rerender。</p>
</li>
<li><p>区分View component 和 pure component。</p>
</li>
</ol>
<h3 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用?"></a>如何使用?</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">mkdir hello</div><div class="line"><span class="built_in">cd</span> hello</div><div class="line">npm init</div><div class="line">npm install react immutable iflux --save</div><div class="line">npm install babel-loader --save-dev</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">➜  iflux-demo  tree -L 3</div><div class="line">.</div><div class="line">├── apps                #we like django&apos;s app-style</div><div class="line">│   └── index           #app-name</div><div class="line">│       ├── index.js    #viewcontainer component</div><div class="line">│       ├── component   #collect of dump components</div><div class="line">│       ├── store.js    #immutable store</div><div class="line">│       └── webapi.js   #fetch remote resource</div><div class="line">├── node_modules</div><div class="line">├── package.json</div><div class="line">└── webpack.config.js</div><div class="line"></div><div class="line">5 directories, 4 files</div></pre></td></tr></table></figure>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//webapi.js</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> fetchGithub = (name) =&gt; &#123;</div><div class="line">  <span class="keyword">return</span> fetch(<span class="string">`http://github.com/<span class="subst">$&#123;name&#125;</span>`</span>)</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  fetchGithub</div><div class="line">&#125;;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//store.js</span></div><div class="line"><span class="keyword">import</span> &#123; Store, msg &#125; <span class="keyword">from</span> <span class="string">'iflux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; fromJS &#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</div><div class="line"><span class="keyword">import</span> &#123; fetchGithub &#125; <span class="keyword">from</span> <span class="string">'./webapi'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> appStore = Store(&#123;</div><div class="line">  name: <span class="string">''</span>,</div><div class="line">  githubInfo: &#123;&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">exports <span class="keyword">default</span> appStore;</div><div class="line"></div><div class="line"><span class="comment">//when use immutable's cursor to update store</span></div><div class="line"><span class="comment">//react's view will auto re-render</span></div><div class="line">msg.on(<span class="string">'updateName'</span>, (name) =&gt; &#123;</div><div class="line">  appStore.cursor().set(<span class="string">'name'</span>, name);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">msg.on(<span class="string">'submit'</span>, <span class="keyword">async</span> () =&gt; &#123;</div><div class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> fetchGithub(name);</div><div class="line">  appStore.cursor.set(<span class="string">'githubInfo'</span>, fromJS(data));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//index.js</span></div><div class="line"></div><div class="line"><span class="comment">//es5的样式</span></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123;msg, mixins&#125; <span class="keyword">from</span> <span class="string">'iflux'</span>;</div><div class="line"><span class="keyword">import</span> appStore <span class="keyword">from</span> <span class="string">'./store'</span>;</div><div class="line"><span class="keyword">const</span> &#123;StoreMixin&#125; = mixins;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">const</span> IfluxApp = React.createClass(&#123;</div><div class="line">  <span class="comment">//自动将Store中的data混入到state</span></div><div class="line">  mixins: [StoreMixin(appStore)],</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">var</span> store = appStore.data();</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;form onSubmit=&#123;this._submit&#125;&gt;</div><div class="line">            &lt;input name="name" onChange=&#123;this._handleChange&#125;/&gt;</div><div class="line">        &lt;/form&gt;</div><div class="line">        &lt;div&gt;</div><div class="line">          &#123;store.get('githubInfo')&#125;</div><div class="line">        &lt;/div&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    );</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  _handleChange(e) &#123;</div><div class="line">    msg.emit('updateName', e.target.value);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  _submit() &#123;</div><div class="line">    msg.emit('getGithubInfo');</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line">//es6的样式</div><div class="line">import React from 'react';</div><div class="line">import &#123; msg, connectToStore &#125; from 'iflux';</div><div class="line">import appStore from './store';</div><div class="line"></div><div class="line">class IfluxApp extends React.Component &#123;</div><div class="line">  render() &#123;</div><div class="line">    const &#123;store&#125; = this.props;</div><div class="line"></div><div class="line">    return (</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;form onSubmit=&#123;this._submit&#125;&gt;</div><div class="line">            &lt;input name="name" onChange=&#123;this._handleChange&#125;/&gt;</div><div class="line">        &lt;/form&gt;</div><div class="line">        &lt;div&gt;</div><div class="line">          &#123;store.get('githubInfo')&#125;</div><div class="line">        &lt;/div&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default connectToStore(appStore)(IfluxApp);</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://RamboLu.top/2017/02/28/ReactNative学习-state与props介绍与比较/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RamboLu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/钢铁侠.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RamboLu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/28/ReactNative学习-state与props介绍与比较/" itemprop="url">
                  ReactNative学习-state与props介绍与比较
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-28T20:33:33+08:00">
                2017-02-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/02/28/ReactNative学习-state与props介绍与比较/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/28/ReactNative学习-state与props介绍与比较/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/02/28/ReactNative学习-state与props介绍与比较/" class="leancloud_visitors" data-flag-title="ReactNative学习-state与props介绍与比较">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、State"><a href="#一、State" class="headerlink" title="一、State"></a>一、State</h2><ul>
<li>state的作用</li>
</ul>
<p>state是React中组件的一个对象.React把用户界面当做是状态机,想象它有不同的状态然后渲染这些状态,可以轻松让用户界面与数据保持一致.</p>
<p>React中,更新组件的state,会导致重新渲染用户界面(不要操作DOM).简单来说,就是用户界面会随着state变化而变化.</p>
<ul>
<li>state工作原理</li>
</ul>
<p>常用的通知React数据变化的方法是调用setState(data,callback).这个方法会合并data到this.state,并重新渲染组件.渲染完成后,调用可选的callback回调.大部分情况不需要提供callback,因为React会负责吧界面更新到最新状态.</p>
<ul>
<li>那些组件应该有state?</li>
</ul>
<p>大部分组件的工作应该是从props里取数据并渲染出来.但是,有时需要对用户输入,服务器请求或者时间变化等作出响应,这时才需要state.</p>
<p>组件应该尽可能的无状态化,这样能隔离state,把它放到最合理的地方(Redux做的就是这个事情?),也能减少冗余并易于解释程序运作过程.</p>
<p>常用的模式就是创建多个只负责渲染数据的无状态(stateless)组件,在他们的上层创建一个有状态(stateful)组件并把它的状态通过props传给子级.有状态的组件封装了所有的用户交互逻辑,而这些无状态组件只负责声明式地渲染数据.</p>
<ul>
<li>哪些应该作为state?</li>
</ul>
<p>state应该包括那些可能被组件的事件处理器改变并触发用户界面更新的数据.这中数据一般很小且能被JSON序列化.当创建一个状态化的组件的时候,应该保持数据的精简,然后存入this.state.在render()中在根据state来计算需要的其他数据.因为如果在state里添加冗余数据或计算所得数据,经常需要手动保持数据同步.</p>
<ul>
<li>那些不应该作为state?</li>
</ul>
<p>this.state应该仅包括能表示用户界面状态所需要的最少数据.因此,不应该包括:</p>
<p>计算所得数据:</p>
<p>React组件:在render()里使用props和state来创建它.</p>
<p>基于props的重复数据:尽可能保持用props来做作为唯一的数据来源.把props保存到state中的有效的场景是需要知道它以前的值得时候,因为未来的props可能会变化.</p>
<h2 id="props"><a href="#props" class="headerlink" title="props"></a>props</h2><ul>
<li>props的作用</li>
</ul>
<p>组件中的props是一种父级向子级传递数据的方式.</p>
<ul>
<li>复合组件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">var Avatar = React.createClass(&#123;</div><div class="line"> 2   render: function() &#123;</div><div class="line"> 3     return (</div><div class="line"> 4       &lt;div&gt;</div><div class="line"> 5         &lt;ProfilePic username=&#123;this.props.username&#125; /&gt;</div><div class="line"> 6         &lt;ProfileLink username=&#123;this.props.username&#125; /&gt;</div><div class="line"> 7       &lt;/div&gt;</div><div class="line"> 8     );</div><div class="line"> 9   &#125;</div><div class="line">10 &#125;);</div><div class="line">11 </div><div class="line">12 var ProfilePic = React.createClass(&#123;</div><div class="line">13   render: function() &#123;</div><div class="line">14     return (</div><div class="line">15       &lt;img src=&#123;&apos;http://graph.facebook.com/&apos; + this.props.username + &apos;/picture&apos;&#125; /&gt;</div><div class="line">16     );</div><div class="line">17   &#125;</div><div class="line">18 &#125;);</div><div class="line">19 </div><div class="line">20 var ProfileLink = React.createClass(&#123;</div><div class="line">21   render: function() &#123;</div><div class="line">22     return (</div><div class="line">23       &lt;a href=&#123;&apos;http://www.facebook.com/&apos; + this.props.username&#125;&gt;</div><div class="line">24         &#123;this.props.username&#125;</div><div class="line">25       &lt;/a&gt;</div><div class="line">26     );</div><div class="line">27   &#125;</div><div class="line">28 &#125;);</div><div class="line">29 </div><div class="line">30 React.render(</div><div class="line">31   &lt;Avatar username=&quot;pwh&quot; /&gt;,</div><div class="line">32   document.getElementById(&apos;example&apos;)</div><div class="line">33 );</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://RamboLu.top/2017/02/25/Mac环境更改shell自定义终端-oh-my-zsh安装及配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RamboLu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/钢铁侠.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RamboLu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/25/Mac环境更改shell自定义终端-oh-my-zsh安装及配置/" itemprop="url">
                  Mac环境更改shell自定义终端-oh my zsh安装及配置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-25T11:00:26+08:00">
                2017-02-25
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/02/25/Mac环境更改shell自定义终端-oh-my-zsh安装及配置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/25/Mac环境更改shell自定义终端-oh-my-zsh安装及配置/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/02/25/Mac环境更改shell自定义终端-oh-my-zsh安装及配置/" class="leancloud_visitors" data-flag-title="Mac环境更改shell自定义终端-oh my zsh安装及配置">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="安装oh-my-zsh"><a href="#安装oh-my-zsh" class="headerlink" title="安装oh my zsh:"></a>安装oh my zsh:</h2><p>1.克隆这个项目到本地（根路径 ~）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone git://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zsh</div></pre></td></tr></table></figure>
<p>2.创建一个zsh的配置文件</p>
<p>注意:如果你已经有一个~/.zshrc文件的话，建议你先做备份。</p>
<ul>
<li>备份配置文件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cp ~/.zshrc ~/.zshrc.orig</div></pre></td></tr></table></figure>
<ul>
<li>然后开始创建zsh的配置文件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc</div></pre></td></tr></table></figure>
<p>3.查看系统内置了几种shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat /etc/shells</div></pre></td></tr></table></figure>
<p>4.设置zsh为你的默认的shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chsh -s /bin/zsh</div></pre></td></tr></table></figure>
<p>5.重启终端</p>
<h2 id="更改zsh主题"><a href="#更改zsh主题" class="headerlink" title="更改zsh主题:"></a>更改zsh主题:</h2><p>1.编辑 ~/.zshrc</p>
<p>2.修改主题<br>Ps：主题文件在 ~/.oh-my-zsh/themes 目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ZSH_THEME=&quot;ys&quot;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://RamboLu.top/2017/02/21/Mac环境使用DigitalOcean租用VPS，部署Docker容器-SS搭建专属梯子/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RamboLu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/钢铁侠.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RamboLu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/21/Mac环境使用DigitalOcean租用VPS，部署Docker容器-SS搭建专属梯子/" itemprop="url">
                  Mac环境使用DigitalOcean租用VPS，部署Docker容器+SS搭建专属梯子
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-21T21:52:55+08:00">
                2017-02-21
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/02/21/Mac环境使用DigitalOcean租用VPS，部署Docker容器-SS搭建专属梯子/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/21/Mac环境使用DigitalOcean租用VPS，部署Docker容器-SS搭建专属梯子/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/02/21/Mac环境使用DigitalOcean租用VPS，部署Docker容器-SS搭建专属梯子/" class="leancloud_visitors" data-flag-title="Mac环境使用DigitalOcean租用VPS，部署Docker容器+SS搭建专属梯子">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>技术在于折腾。</p>
</blockquote>
<p>一、DigitalOcean官网注册<br><a href="https://cloud.digitalocean.com/" target="_blank" rel="external">https://cloud.digitalocean.com/</a><br>ps：注册费用$5，现在还送$10，一共$15,如果选用最便宜的服务器，可以使用3个月。<br><img src="http://upload-images.jianshu.io/upload_images/1666327-c528d190dab09ee3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="DigitalOcean官网"><br>二、创建虚拟服务器</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-e4559747abf846b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建虚拟服务器"></p>
<p>三、选择服务器</p>
<ul>
<li>系统默认是乌班图，喜欢CoreOS、CentOS可以自行选择</li>
<li>价钱是每月的使用费以及设备的配置，如果平时上网话，5刀的足以</li>
<li>线路使用纽约、旧金山都可以，建议使用旧金山的<br><img src="http://upload-images.jianshu.io/upload_images/1666327-ea46899a01e5a007.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="选择服务器、使用金额及线路"><br>四、选择连接方式，建议使用ssh连接(安全)</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-579a658a82cf16f0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="选择设置ssh"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-d8cf08dd3ed44f8a.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="配置ssh"><br>ps：关于配置ssh可以在settings里面找到。</p>
<ul>
<li>生成ssh，可以参考github官方生成文档：<a href="https://help.github.com/articles/connecting-to-github-with-ssh/" target="_blank" rel="external">https://help.github.com/articles/connecting-to-github-with-ssh/</a></li>
<li>查看ssh,可以通过查找文件输入 <em>~/.ssh</em>的方式<br>具体查看公钥<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat ~/.ssh/id_rsa.pub</div></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-ad7c75321bc57179.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看ssh"></p>
<ul>
<li>再把查看的公钥粘贴至对话框</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-faa39f8b0a849441.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="粘贴ssh"></p>
<p>四、连接服务器<br><img src="http://upload-images.jianshu.io/upload_images/1666327-d50805f02617e517.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="虚拟服务器IP"></p>
<ul>
<li>连接服务器，生成的IP地址</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh root@xxx.xxx.xxx.xxx</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-804ba850fb461acc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="连接服务器"></p>
<ul>
<li>部署docker容器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apt install docker.io</div></pre></td></tr></table></figure>
<ul>
<li>拉取shadowsocks 仓库</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker pull oddrationale/docker-shadowsocks</div></pre></td></tr></table></figure>
<ul>
<li><p>设置仓库的端口、密码、及加密方式<br>ps：<br>xxxxxx 是你要设置的密码<br>1984 是你的端口号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker run -d -p 1984:1984 oddrationale/docker-shadowsocks -s 0.0.0.0 -p 1984 -k xxxxxx -m aes-256-cfb</div></pre></td></tr></table></figure>
</li>
<li><p>查看docker 列表<br>ps：如果出现up就表明部署成功</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker ps</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-f5b68806ffe2040d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="看到docker容器的列表"><br>五、下载ss客户端（shadowsocks），并添加。<br>GitHub官方提供下载dmg：<br><a href="https://github.com/shadowsocks/shadowsocks-iOS/releases" target="_blank" rel="external">https://github.com/shadowsocks/shadowsocks-iOS/releases</a></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-a926bcfd857363fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="shadowsocks下载"></p>
<ul>
<li>安装后配置服务器，打开服务器设置，并添加服务器。<br><img src="http://upload-images.jianshu.io/upload_images/1666327-d24a0c10167502ac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加服务器"></li>
<li>把创建的服务器Ip、端口号及创建的加密方式密码填入即可<br>ps：<br>默认端口号填写的<em>1984</em><br>加密方式选择<em>aes-256-cfb</em><br><img src="http://upload-images.jianshu.io/upload_images/1666327-a5d24645b774e6fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="设定服务器"></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://RamboLu.top/2017/02/13/Node之package-json文件解析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RamboLu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/钢铁侠.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RamboLu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/13/Node之package-json文件解析/" itemprop="url">
                  Node之Package.json文件参数解析
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-13T14:12:00+08:00">
                2017-02-13
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/02/13/Node之package-json文件解析/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/13/Node之package-json文件解析/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/02/13/Node之package-json文件解析/" class="leancloud_visitors" data-flag-title="Node之Package.json文件参数解析">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考JavaScript 标准参考教程（alpha）<a href="http://javascript.ruanyifeng.com/nodejs/packagejson.html#toc0" target="_blank" rel="external">http://javascript.ruanyifeng.com/nodejs/packagejson.html#toc0</a></p>
<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><ul>
<li>package.json在Node项目中用于描述项目的一些基本信息，以及依赖库的配置，一般每一个Node项目的根目录下都有一个package.json文件。</li>
<li>在项目的根目录中package.json文件可以手工编写，也可以使用npm init命令自动生成，其内容是一个Json对象。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm init</div></pre></td></tr></table></figure>
<p>基本结构如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;name&quot;: &quot;package&quot;,</div><div class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</div><div class="line">  &quot;description&quot;: &quot;&quot;,</div><div class="line">  &quot;main&quot;: &quot;index.js&quot;,</div><div class="line">  &quot;dependencies&quot;: &#123;</div><div class="line">    &quot;babel-cli&quot;: &quot;^6.23.0&quot;,</div><div class="line">    &quot;babel-preset-env&quot;: &quot;^1.1.8&quot;,</div><div class="line">    &quot;hexo&quot;: &quot;^3.2.0&quot;,</div><div class="line">    &quot;immutable&quot;: &quot;^3.8.1&quot;,</div><div class="line">    &quot;iflux&quot;: &quot;^1.2.16&quot;</div><div class="line">  &#125;,</div><div class="line">  &quot;devDependencies&quot;: &#123;&#125;,</div><div class="line">  &quot;scripts&quot;: &#123;</div><div class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</div><div class="line">  &#125;,</div><div class="line">  &quot;author&quot;: &quot;&quot;,</div><div class="line">  &quot;license&quot;: &quot;ISC&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="scripts字段"><a href="#scripts字段" class="headerlink" title="scripts字段"></a>scripts字段</h3><p>参考文献npm scripts 使用指南 By阮一峰<br><a href="http://www.ruanyifeng.com/blog/2016/10/npm_scripts.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2016/10/npm_scripts.html</a><br>scripts的每一个属性，对应一段脚本。是指定了运行脚本命令的npm命令行缩写，比如start 属性指定了运行npm run start时，所要执行的命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">npm run start</div><div class="line"># 等同于执行</div><div class="line">node index.js</div></pre></td></tr></table></figure>
<p>下面的设置指定了npm run preinstall、npm run postinstall、npm run start、npm run test时，所要执行的命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&quot;scripts&quot;: &#123;</div><div class="line">    &quot;preinstall&quot;: &quot;echo here it comes!&quot;,</div><div class="line">    &quot;postinstall&quot;: &quot;echo there it goes!&quot;,</div><div class="line">    &quot;start&quot;: &quot;node index.js&quot;,</div><div class="line">    &quot;test&quot;: &quot;tap test/*.js&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="dependencies字段，devDependencies字段"><a href="#dependencies字段，devDependencies字段" class="headerlink" title="dependencies字段，devDependencies字段"></a>dependencies字段，devDependencies字段</h3><p>dependencies字段指定了项目运行所依赖的模块，devDependencies指定项目开发所需要的模块。</p>
<p>它们都指向一个对象。该对象的各个成员，分别由模块名和对应的版本要求组成，表示依赖的模块及其版本范围。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;devDependencies&quot;: &#123;</div><div class="line">    &quot;browserify&quot;: &quot;~13.0.0&quot;,</div><div class="line">    &quot;karma-browserify&quot;: &quot;~5.0.1&quot;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>指定版本：比如1.2.2，遵循“大版本.次要版本.小版本”的格式规定，安装时只安装指定版本。</li>
<li>波浪号（tilde）+指定版本：比如~1.2.2，表示安装1.2.x的最新版本（不低于1.2.2），但是不安装1.3.x，也就是说安装时不改变大版本号和次要版本号。</li>
<li>插入号（caret）+指定版本：比如ˆ1.2.2，表示安装1.x.x的最新版本（不低于1.2.2），但是不安装2.x.x，也就是说安装时不改变大版本号。需要注意的是，如果大版本号为0，则插入号的行为与波浪号相同，这是因为此时处于开发阶段，即使是次要版本号变动，也可能带来程序的不兼容。</li>
<li>latest：安装最新版本。</li>
</ul>
<p>安装所需要的模块吗，直接使用npm install命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install XXXX</div></pre></td></tr></table></figure>
<p>如果一个模块不在package.json文件之中，可以单独安装这个模块，并使用相应的参数，将其写入package.json文件之中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">npm install express --save</div><div class="line"></div><div class="line">npm install express --save-dev</div></pre></td></tr></table></figure>
<p>上面代码表示单独安装express模块，<br>–save     表示将该模块写入dependencies属性，<br>–save-dev 表示将该模块写入devDependencies属性。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://RamboLu.top/2016/12/24/ReactNative学习-React-js全家桶/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RamboLu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/钢铁侠.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RamboLu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/24/ReactNative学习-React-js全家桶/" itemprop="url">
                  ReactNative学习-React技术栈全家桶
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-24T15:26:03+08:00">
                2016-12-24
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/12/24/ReactNative学习-React-js全家桶/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/24/ReactNative学习-React-js全家桶/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/12/24/ReactNative学习-React-js全家桶/" class="leancloud_visitors" data-flag-title="ReactNative学习-React技术栈全家桶">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="React-技术栈系列教程"><a href="#React-技术栈系列教程" class="headerlink" title="React 技术栈系列教程"></a>React 技术栈系列教程</h4><p><a href="http://www.ruanyifeng.com/blog/2016/09/react-technology-stack.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2016/09/react-technology-stack.html</a></p>
<h4 id="React-js-入门教程"><a href="#React-js-入门教程" class="headerlink" title="React.js 入门教程"></a>React.js 入门教程</h4><p><a href="http://www.ruanyifeng.com/blog/2015/03/react.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2015/03/react.html</a></p>
<h4 id="ECMAScript-6-入门"><a href="#ECMAScript-6-入门" class="headerlink" title="ECMAScript 6 入门"></a>ECMAScript 6 入门</h4><p><a href="http://es6.ruanyifeng.com/#docs/style" target="_blank" rel="external">http://es6.ruanyifeng.com/#docs/style</a></p>
<h4 id="ReactNative-中文网"><a href="#ReactNative-中文网" class="headerlink" title="ReactNative 中文网"></a>ReactNative 中文网</h4><p><a href="http://reactnative.cn" target="_blank" rel="external">http://reactnative.cn</a></p>
<h4 id="Immutable-详解及-React-中实践"><a href="#Immutable-详解及-React-中实践" class="headerlink" title="Immutable 详解及 React 中实践"></a>Immutable 详解及 React 中实践</h4><p><a href="https://zhuanlan.zhihu.com/p/20295971?columnSlug=purerender" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/20295971?columnSlug=purerender</a></p>
<h4 id="Flux-架构入门教程"><a href="#Flux-架构入门教程" class="headerlink" title="Flux 架构入门教程"></a>Flux 架构入门教程</h4><p><a href="http://www.ruanyifeng.com/blog/2016/01/flux.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2016/01/flux.html</a></p>
<h4 id="Flux-架构官方英文文档"><a href="#Flux-架构官方英文文档" class="headerlink" title="Flux 架构官方英文文档"></a>Flux 架构官方英文文档</h4><p><a href="https://facebook.github.io/flux/docs/overview.html#content" target="_blank" rel="external">https://facebook.github.io/flux/docs/overview.html#content</a></p>
<h4 id="Redux-入门教程（一）：基本用法"><a href="#Redux-入门教程（一）：基本用法" class="headerlink" title="Redux 入门教程（一）：基本用法"></a>Redux 入门教程（一）：基本用法</h4><p><a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_one_basic_usages.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_one_basic_usages.html</a></p>
<h4 id="Redux-入门教程（二）：中间件（middleware）与异步操作"><a href="#Redux-入门教程（二）：中间件（middleware）与异步操作" class="headerlink" title="Redux 入门教程（二）：中间件（middleware）与异步操作"></a>Redux 入门教程（二）：中间件（middleware）与异步操作</h4><p><a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_two_async_operations.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_two_async_operations.html</a></p>
<h4 id="Redux-入门教程（三）：React-Redux-的用法"><a href="#Redux-入门教程（三）：React-Redux-的用法" class="headerlink" title="Redux 入门教程（三）：React-Redux 的用法"></a>Redux 入门教程（三）：React-Redux 的用法</h4><p><a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_three_react-redux.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_three_react-redux.html</a></p>
<h4 id="Redux-js-官方英文文档"><a href="#Redux-js-官方英文文档" class="headerlink" title="Redux.js 官方英文文档"></a>Redux.js 官方英文文档</h4><p><a href="http://redux.js.org" target="_blank" rel="external">http://redux.js.org</a></p>
<h4 id="Redux-js-GitHub中文文档"><a href="#Redux-js-GitHub中文文档" class="headerlink" title="Redux.js GitHub中文文档"></a>Redux.js GitHub中文文档</h4><p><a href="http://cn.redux.js.org/docs/react-redux/api.html" target="_blank" rel="external">http://cn.redux.js.org/docs/react-redux/api.html</a></p>
<h4 id="Flex-布局教程：语法篇"><a href="#Flex-布局教程：语法篇" class="headerlink" title="Flex 布局教程：语法篇"></a>Flex 布局教程：语法篇</h4><p><a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html?utm_source=tuicool" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html?utm_source=tuicool</a></p>
<h4 id="浅谈-React、Flux-与-Redux"><a href="#浅谈-React、Flux-与-Redux" class="headerlink" title="浅谈 React、Flux 与 Redux"></a>浅谈 React、Flux 与 Redux</h4><p><a href="http://www.tuicool.com/articles/3AFJNbj" target="_blank" rel="external">http://www.tuicool.com/articles/3AFJNbj</a></p>
<h4 id="怎样理顺react，flux，redux这些概念的关系，开发中有必要使用它们吗"><a href="#怎样理顺react，flux，redux这些概念的关系，开发中有必要使用它们吗" class="headerlink" title="怎样理顺react，flux，redux这些概念的关系，开发中有必要使用它们吗?"></a>怎样理顺react，flux，redux这些概念的关系，开发中有必要使用它们吗?</h4><p><a href="https://www.zhihu.com/question/47686258/answer/107209140" target="_blank" rel="external">https://www.zhihu.com/question/47686258/answer/107209140</a></p>
<h2 id="DEMO文章："><a href="#DEMO文章：" class="headerlink" title="DEMO文章："></a>DEMO文章：</h2><h4 id="这段时间看了下Redux，写自己对它的感觉。"><a href="#这段时间看了下Redux，写自己对它的感觉。" class="headerlink" title="这段时间看了下Redux，写自己对它的感觉。"></a>这段时间看了下Redux，写自己对它的感觉。</h4><p><a href="http://react-china.org/t/redux/2687" target="_blank" rel="external">http://react-china.org/t/redux/2687</a></p>
<h4 id="基于-react-react-router-redux-webpack-ES6-7-less-的完整项目"><a href="#基于-react-react-router-redux-webpack-ES6-7-less-的完整项目" class="headerlink" title="基于 react + react-router + redux + webpack + ES6/7 + less 的完整项目"></a>基于 react + react-router + redux + webpack + ES6/7 + less 的完整项目</h4><p><a href="https://github.com/bailicangdu/react-pxq" target="_blank" rel="external">https://github.com/bailicangdu/react-pxq</a></p>
<h4 id="基于webpack-react-react-router-redux-less-flex-css-ES6-的React版cnode社区"><a href="#基于webpack-react-react-router-redux-less-flex-css-ES6-的React版cnode社区" class="headerlink" title="基于webpack + react + react-router + redux + less + flex.css + ES6 的React版cnode社区"></a>基于webpack + react + react-router + redux + less + flex.css + ES6 的React版cnode社区</h4><p><a href="http://react-china.org/t/webpack-react-react-router-redux-less-flex-css-es6-react-cnode/6332" target="_blank" rel="external">http://react-china.org/t/webpack-react-react-router-redux-less-flex-css-es6-react-cnode/6332</a></p>
<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>大前端的时代来了，还不要准备好么？</p>
<h2 id="做React需要会什么？"><a href="#做React需要会什么？" class="headerlink" title="做React需要会什么？"></a>做React需要会什么？</h2><p>react的功能其实很单一，主要负责渲染的功能，现有的框架，比如angular是一个大而全的框架，用了angular几乎就不需要用其他工具辅助配合，但是react不一样，他只负责ui渲染，想要做好一个项目，往往需要其他库和工具的配合，比如用redux来管理数据，react-router管理路由，react已经全面拥抱es6，所以es6也得掌握，webpack就算是不会配置也要会用，要想提高性能，需要按需加载，immutable.js也得用上，还有单元测试等。</p>
<h2 id="React-是什么"><a href="#React-是什么" class="headerlink" title="React 是什么"></a>React 是什么</h2><p>用脚本进行DOM操作的代价很昂贵。有个贴切的比喻，把DOM和JavaScript各自想象为一个岛屿，它们之间用收费桥梁连接，js每次访问DOM，都要途径这座桥，并交纳“过桥费”,访问DOM的次数越多，费用也就越高。 因此，推荐的做法是尽量减少过桥的次数，努力待在ECMAScript岛上。因为这个原因react的虚拟dom就显得难能可贵了，它创造了虚拟dom并且将它们储存起来，每当状态发生变化的时候就会创造新的虚拟节点和以前的进行对比，让变化的部分进行渲染。整个过程没有对dom进行获取和操作，只有一个渲染的过程，所以react说是一个ui框架。</p>
<h2 id="React的组件化"><a href="#React的组件化" class="headerlink" title="React的组件化"></a>React的组件化</h2><p>react的一个组件很明显的由dom视图和state数据组成，两个部分泾渭分明。state是数据中心，它的状态决定着视图的状态。这时候发现似乎和我们一直推崇的MVC开发模式有点区别，没了Controller控制器，那用户交互怎么处理，数据变化谁来管理？然而这并不是react所要关心的事情，它只负责ui的渲染。与其他框架监听数据动态改变dom不同，react采用setState来控制视图的更新。setState会自动调用render函数，触发视图的重新渲染，如果仅仅只是state数据的变化而没有调用setState，并不会触发更新。 组件就是拥有独立功能的视图模块，许多小的组件组成一个大的组件，整个页面就是由一个个组件组合而成。它的好处是利于重复利用和维护。</p>
<h2 id="React的-Diff算法"><a href="#React的-Diff算法" class="headerlink" title="React的 Diff算法"></a>React的 Diff算法</h2><p>react的diff算法用在什么地方呢？当组件更新的时候，react会创建一个新的虚拟dom树并且会和之前储存的dom树进行比较，这个比较多过程就用到了diff算法，所以组件初始化的时候是用不到的。react提出了一种假设，相同的节点具有类似的结构，而不同的节点具有不同的结构。在这种假设之上进行逐层的比较，如果发现对应的节点是不同的，那就直接删除旧的节点以及它所包含的所有子节点然后替换成新的节点。如果是相同的节点，则只进行属性的更改。</p>
<p>对于列表的diff算法稍有不同，因为列表通常具有相同的结构，在对列表节点进行删除，插入，排序的时候，单个节点的整体操作远比一个个对比一个个替换要好得多，所以在创建列表的时候需要设置key值，这样react才能分清谁是谁。当然不写key值也可以，但这样通常会报出警告，通知我们加上key值以提高react的性能。</p>
<p><img src="https://github.com/bailicangdu/pxq/blob/master/src/images/diff.png" alt=""></p>
<h2 id="React组件是怎么来的"><a href="#React组件是怎么来的" class="headerlink" title="React组件是怎么来的"></a>React组件是怎么来的</h2><p>组件的创造方法为React.createClass() ——创造一个类，react系统内部设计了一套类系统，利用它来创造react组件。但这并不是必须的，我们还可以用es6的class类来创造组件,这也是Facebook官方推荐的写法。</p>
<p><img src="https://github.com/bailicangdu/pxq/blob/master/src/images/icon_class.png" alt=""></p>
<p>这两种写法实现的功能一样但是原理却是不同，es6的class类可以看作是构造函数的一个语法糖，可以把它当成构造函数来看，extends实现了类之间的继承 —— 定义一个类Main 继承React.Component所有的属性和方法，组件的生命周期函数就是从这来的。constructor是构造器，在实例化对象时调用，super调用了父类的constructor创造了父类的实例对象this，然后用子类的构造函数进行修改。这和es5的原型继承是不同的，原型继承是先创造一个实例化对象this，然后再继承父级的原型方法。了解了这些之后我们在看组件的时候就清楚很多。</p>
<p>当我们使用组件&lt; Main /&gt;时，其实是对Main类的实例化——new Main，只不过react对这个过程进行了封装，让它看起来更像是一个标签。</p>
<p>有三点值得注意：1、定义类名字的首字母必须大写 2、因为class变成了关键字，类选择器需要用className来代替。 3、类和模块内部默认使用严格模式，所以不需要用use strict指定运行模式。</p>
<h2 id="组件的生命周期"><a href="#组件的生命周期" class="headerlink" title="组件的生命周期"></a>组件的生命周期</h2><p><img src="https://github.com/bailicangdu/pxq/blob/master/src/images/react-lifecycle.png" alt=""></p>
<p><strong>组件在初始化时会触发5个钩子函数：</strong></p>
<p>  <strong>1、getDefaultProps()</strong> </p>
<blockquote>
<p>设置默认的props，也可以用dufaultProps设置组件的默认属性。</p>
</blockquote>
<p>  <strong>2、getInitialState()</strong>  </p>
<blockquote>
<p>在使用es6的class语法时是没有这个钩子函数的，可以直接在constructor中定义this.state。此时可以访问this.props。</p>
</blockquote>
<p> <strong>3、componentWillMount()</strong> </p>
<blockquote>
<p>组件初始化时只调用，以后组件更新不调用，整个生命周期只调用一次，此时可以修改state。</p>
</blockquote>
<p> <strong>4、 render()</strong> </p>
<blockquote>
<p> react最重要的步骤，创建虚拟dom，进行diff算法，更新dom树都在此进行。此时就不能更改state了。</p>
</blockquote>
<p> <strong>5、componentDidMount()</strong> </p>
<blockquote>
<p>组件渲染之后调用，可以通过this.getDOMNode()获取和操作dom节点，只调用一次。</p>
</blockquote>
<p><strong>在更新时也会触发5个钩子函数：</strong></p>
<p>  <strong>6、componentWillReceivePorps(nextProps)</strong></p>
<blockquote>
<p>组件初始化时不调用，组件接受新的props时调用。</p>
</blockquote>
<p>  <strong>7、shouldComponentUpdate(nextProps, nextState)</strong> </p>
<blockquote>
<p>react性能优化非常重要的一环。组件接受新的state或者props时调用，我们可以设置在此对比前后两个props和state是否相同，如果相同则返回false阻止更新，因为相同的属性状态一定会生成相同的dom树，这样就不需要创造新的dom树和旧的dom树进行diff算法对比，节省大量性能，尤其是在dom结构复杂的时候。不过调用this.forceUpdate会跳过此步骤。</p>
</blockquote>
<p>  <strong>8、componentWillUpdata(nextProps, nextState)</strong></p>
<blockquote>
<p>组件初始化时不调用，只有在组件将要更新时才调用，此时可以修改state</p>
</blockquote>
<p>  <strong>9、render()</strong></p>
<blockquote>
<p>不多说</p>
</blockquote>
<p>  <strong>10、componentDidUpdate()</strong></p>
<blockquote>
<p>组件初始化时不调用，组件更新完成后调用，此时可以获取dom节点。</p>
</blockquote>
<p>还有一个卸载钩子函数</p>
<p>  <strong>11、componentWillUnmount()</strong> </p>
<blockquote>
<p>组件将要卸载时调用，一些事件监听和定时器需要在此时清除。</p>
</blockquote>
<p>以上可以看出来react总共有10个周期函数（render重复一次），这个10个函数可以满足我们所有对组件操作的需求，利用的好可以提高开发效率和组件性能。</p>
<h2 id="React-Router路由"><a href="#React-Router路由" class="headerlink" title="React-Router路由"></a>React-Router路由</h2><p>Router就是React的一个组件，它并不会被渲染，只是一个创建内部路由规则的配置对象，根据匹配的路由地址展现相应的组件。Route则对路由地址和组件进行绑定，Route具有嵌套功能，表示路由地址的包涵关系，这和组件之间的嵌套并没有直接联系。Route可以向绑定的组件传递7个属性：children，history，location，params，route，routeParams，routes，每个属性都包涵路由的相关的信息。比较常用的有children（以路由的包涵关系为区分的组件），location（包括地址，参数，地址切换方式，key值，hash值）。react-router提供Link标签，这只是对a标签的封装，值得注意的是，点击链接进行的跳转并不是默认的方式，react-router阻止了a标签的默认行为并用pushState进行hash值的转变。切换页面的过程是在点击Link标签或者后退前进按钮时，会先发生url地址的转变，Router监听到地址的改变根据Route的path属性匹配到对应的组件，将state值改成对应的组件并调用setState触发render函数重新渲染dom。</p>
<p>当页面比较多时，项目就会变得越来越大，尤其对于单页面应用来说，初次渲染的速度就会很慢，这时候就需要按需加载，只有切换到页面的时候才去加载对应的js文件。react配合webpack进行按需加载的方法很简单，Route的component改为getComponent，组件用require.ensure的方式获取，并在webpack中配置chunkFilename。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> chooseProducts = (location, cb) =&gt; &#123;</div><div class="line">    <span class="built_in">require</span>.ensure([], <span class="built_in">require</span> =&gt; &#123;</div><div class="line">        cb(<span class="literal">null</span>, <span class="built_in">require</span>(<span class="string">'../Component/chooseProducts'</span>).default)</div><div class="line">    &#125;,<span class="string">'chooseProducts'</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> helpCenter = (location, cb) =&gt; &#123;</div><div class="line">    <span class="built_in">require</span>.ensure([], <span class="built_in">require</span> =&gt; &#123;</div><div class="line">        cb(<span class="literal">null</span>, <span class="built_in">require</span>(<span class="string">'../Component/helpCenter'</span>).default)</div><div class="line">    &#125;,<span class="string">'helpCenter'</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> saleRecord = (location, cb) =&gt; &#123;</div><div class="line">    <span class="built_in">require</span>.ensure([], <span class="built_in">require</span> =&gt; &#123;</div><div class="line">        cb(<span class="literal">null</span>, <span class="built_in">require</span>(<span class="string">'../Component/saleRecord'</span>).default)</div><div class="line">    &#125;,<span class="string">'saleRecord'</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> RouteConfig = (</div><div class="line">    &lt;Router history=&#123;history&#125;&gt;</div><div class="line">        &lt;Route path="/" component=&#123;Roots&#125;&gt;</div><div class="line">            &lt;IndexRoute component=&#123;index&#125; /&gt;//首页</div><div class="line">            &lt;Route path="index" component=&#123;index&#125; /&gt;</div><div class="line">            &lt;Route path="helpCenter" getComponent=&#123;helpCenter&#125; /&gt;//帮助中心</div><div class="line">            &lt;Route path="saleRecord" getComponent=&#123;saleRecord&#125; /&gt;//销售记录</div><div class="line">            &lt;Redirect from='*' to='/'  /&gt;</div><div class="line">        &lt;/Route&gt;</div><div class="line">    &lt;/Router&gt;</div><div class="line">);</div></pre></td></tr></table></figure>
<h2 id="组件之间的通信"><a href="#组件之间的通信" class="headerlink" title="组件之间的通信"></a>组件之间的通信</h2><p>react推崇的是单向数据流，自上而下进行数据的传递，但是由下而上或者不在一条数据流上的组件之间的通信就会变的复杂。解决通信问题的方法很多，如果只是父子级关系，父级可以将一个回调函数当作属性传递给子级，子级可以直接调用函数从而和父级通信。</p>
<p>组件层级嵌套到比较深，可以使用上下文getChildContext来传递信息，这样在不需要将函数一层层往下传，任何一层的子级都可以通过this.context直接访问。</p>
<p>兄弟关系的组件之间无法直接通信，它们只能利用同一层的上级作为中转站。而如果兄弟组件都是最高层的组件，为了能够让它们进行通信，必须在它们外层再套一层组件，这个外层的组件起着保存数据，传递信息的作用，这其实就是redux所做的事情。</p>
<p>组件之间的信息还可以通过全局事件来传递。不同页面可以通过参数传递数据，下个页面可以用location.param来获取。其实react本身很简单，难的在于如何优雅高效的实现组件之间数据的交流。</p>
<h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><p>首先，redux并不是必须的，它的作用相当于在顶层组件之上又加了一个组件，作用是进行逻辑运算、储存数据和实现组件尤其是顶层组件的通信。如果组件之间的交流不多，逻辑不复杂，只是单纯的进行视图的渲染，这时候用回调，context就行，没必要用redux，用了反而影响开发速度。但是如果组件交流特别频繁，逻辑很复杂，那redux的优势就特别明显了。我第一次做react项目的时候并没有用redux，所有的逻辑都是在组件内部实现，当时为了实现一个逻辑比较复杂的购物车，洋洋洒洒居然写了800多行代码，回头一看我自己都不知道写的是啥，画面太感人。</p>
<p>先简单说一下redux和react是怎么配合的。react-redux提供了connect和Provider两个好基友，它们一个将组件与redux关联起来，一个将store传给组件。组件通过dispatch发出action，store根据action的type属性调用对应的reducer并传入state和这个action，reducer对state进行处理并返回一个新的state放入store，connect监听到store发生变化，调用setState更新组件，此时组件的props也就跟着变化。</p>
<h4 id="流程是这个样子的："><a href="#流程是这个样子的：" class="headerlink" title="流程是这个样子的："></a>流程是这个样子的：</h4><p><img src="https://github.com/bailicangdu/pxq/blob/master/src/images/simple_redux.jpg" alt=""></p>
<p>值得注意的是connect，Provider，mapStateToProps,mapDispatchToProps是react-redux提供的，redux本身和react没有半毛钱关系，它只是数据处理中心，没有和react产生任何耦合，是react-redux让它们联系在一起。</p>
<h4 id="接下来具体分析一下，redux以及react-redux到底是怎么实现的。"><a href="#接下来具体分析一下，redux以及react-redux到底是怎么实现的。" class="headerlink" title="接下来具体分析一下，redux以及react-redux到底是怎么实现的。"></a>接下来具体分析一下，redux以及react-redux到底是怎么实现的。</h4><h4 id="先上一张图"><a href="#先上一张图" class="headerlink" title="先上一张图"></a>先上一张图</h4><p><img src="https://github.com/bailicangdu/pxq/blob/master/src/images/all_redux.png" alt=""></p>
<p>明显比第一张要复杂，其实两张图说的是同一件事。从上而下慢慢分析：</p>
<h3 id="先说说redux："><a href="#先说说redux：" class="headerlink" title="先说说redux："></a>先说说redux：</h3><h4 id="redux主要由三部分组成：store，reducer，action。"><a href="#redux主要由三部分组成：store，reducer，action。" class="headerlink" title="redux主要由三部分组成：store，reducer，action。"></a>redux主要由三部分组成：store，reducer，action。</h4><p><strong>store</strong>是一个对象，它有四个主要的方法：</p>
<p><strong>1、dispatch:</strong></p>
<blockquote>
<p> 用于action的分发——在createStore中可以用middleware中间件对dispatch进行改造，比如当action传入dispatch会立即触发reducer，有些时候我们不希望它立即触发，而是等待异步操作完成之后再触发，这时候用redux-thunk对dispatch进行改造，以前只能传入一个对象，改造完成后可以传入一个函数，在这个函数里我们手动dispatch一个action对象，这个过程是可控的，就实现了异步。</p>
</blockquote>
<p><strong>2、subscribe：</strong></p>
<blockquote>
<p>监听state的变化——这个函数在store调用dispatch时会注册一个listener监听state变化，当我们需要知道state是否变化时可以调用，它返回一个函数，调用这个返回的函数可以注销监听。<br>let unsubscribe = store.subscribe(() =&gt; {console.log(‘state发生了变化’)})</p>
</blockquote>
<p><strong>3、getState：</strong></p>
<blockquote>
<p>获取store中的state——当我们用action触发reducer改变了state时，需要再拿到新的state里的数据，毕竟数据才是我们想要的。getState主要在两个地方需要用到，一是在dispatch拿到action后store需要用它来获取state里的数据，并把这个数据传给reducer，这个过程是自动执行的，二是在我们利用subscribe监听到state发生变化后调用它来获取新的state数据，如果做到这一步，说明我们已经成功了。</p>
</blockquote>
<p><strong>4、replaceReducer:</strong> </p>
<blockquote>
<p>替换reducer，改变state修改的逻辑。</p>
</blockquote>
<p>store可以通过createStore()方法创建，接受三个参数，经过combineReducers合并的reducer和state的初始状态以及改变dispatch的中间件，后两个参数并不是必须的。store的主要作用是将action和reducer联系起来并改变state。</p>
<p><strong>action:</strong></p>
<blockquote>
<p>action是一个对象，其中type属性是必须的，同时可以传入一些数据。action可以用actionCreactor进行创造。dispatch就是把action对象发送出去。</p>
</blockquote>
<p><strong>reducer:</strong></p>
<blockquote>
<p>reducer是一个函数，它接受一个state和一个action，根据action的type返回一个新的state。根据业务逻辑可以分为很多个reducer，然后通过combineReducers将它们合并，state树中有很多对象，每个state对象对应一个reducer，state对象的名字可以在合并时定义。</p>
</blockquote>
<p>像这个样子：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> reducer = combineReducers(&#123;</div><div class="line">     a: doSomethingWithA,</div><div class="line">     b: processB,</div><div class="line">     c: c</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><strong>combineReducers:</strong></p>
<blockquote>
<p>其实它也是一个reducer，它接受整个state和一个action，然后将整个state拆分发送给对应的reducer进行处理，所有的reducer会收到相同的action，不过它们会根据action的type进行判断，有这个type就进行处理然后返回新的state，没有就返回默认值，然后这些分散的state又会整合在一起返回一个新的state树。</p>
</blockquote>
<p>接下来分析一下整体的流程，首先调用store.dispatch将action作为参数传入，同时用getState获取当前的状态树state并注册subscribe的listener监听state变化，再调用combineReducers并将获取的state和action传入。combineReducers会将传入的state和action传给所有reducer，reducer会根据state的key值获取与自己对应的state，并根据action的type返回新的state，触发state树的更新，我们调用subscribe监听到state发生变化后用getState获取新的state数据。</p>
<p>redux的state和react的state两者完全没有关系，除了名字一样。</p>
<p><strong>上面分析了redux的主要功能，那么react-redux到底做了什么？</strong></p>
<h2 id="React-Redux"><a href="#React-Redux" class="headerlink" title="React-Redux"></a>React-Redux</h2><p>如果只使用redux，那么流程是这样的：</p>
<blockquote>
<p>component –&gt; dispatch(action) –&gt; reducer –&gt; subscribe –&gt; getState –&gt; component</p>
</blockquote>
<p>用了react-redux之后流程是这样的：</p>
<blockquote>
<p>component –&gt; actionCreator(data) –&gt; reducer –&gt; component</p>
</blockquote>
<p>store的三大功能：dispatch，subscribe，getState都不需要手动来写了。react-redux帮我们做了这些，同时它提供了两个好基友Provider和connect。</p>
<p><strong>Provider</strong>是一个组件，它接受store作为props，然后通过context往下传，这样react中任何组件都可以通过contex获取store。也就意味着我们可以在任何一个组件里利用dispatch(action)来触发reducer改变state，并用subscribe监听state的变化，然后用getState获取变化后的值。但是并不推荐这样做，它会让数据流变的混乱，过度的耦合也会影响组件的复用，维护起来也更麻烦。</p>
<p><strong>connect –connect(mapStateToProps, mapDispatchToProps, mergeProps, options)</strong>是一个函数，它接受四个参数并且再返回一个函数–wrapWithConnect，wrapWithConnect接受一个组件作为参数wrapWithConnect(component)，它内部定义一个新组件Connect(容器组件)并将传入的组件(ui组件)作为Connect的子组件然后return出去。</p>
<p>所以它的完整写法是这样的：connect(mapStateToProps, mapDispatchToProps, mergeProps, options)(component)</p>
<p><strong>mapStateToProps(state, [ownProps])：</strong></p>
<blockquote>
<p>mapStateToProps 接受两个参数，store的state和自定义的props，并返回一个新的对象，这个对象会作为props的一部分传入ui组件。我们可以根据组件所需要的数据自定义返回一个对象。ownProps的变化也会触发mapStateToProps</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</div><div class="line">   <span class="keyword">return</span> &#123; todos: state.todos &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>mapDispatchToProps(dispatch, [ownProps])：</strong></p>
<blockquote>
<p>mapDispatchToProps如果是对象，那么会和store绑定作为props的一部分传入ui组件。如果是个函数，它接受两个参数，bindActionCreators会将action和dispatch绑定并返回一个对象，这个对象会和ownProps一起作为props的一部分传入ui组件。所以不论mapDispatchToProps是对象还是函数，它最终都会返回一个对象，如果是函数，这个对象的key值是可以自定义的</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>) </span>&#123;</div><div class="line">   <span class="keyword">return</span> &#123;</div><div class="line">      todoActions: bindActionCreators(todoActionCreators, dispatch),</div><div class="line">      counterActions: bindActionCreators(counterActionCreators, dispatch)</div><div class="line">   &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>mapDispatchToProps返回的对象其属性其实就是一个个actionCreator，因为已经和dispatch绑定，所以当调用actionCreator时会立即发送action，而不用手动dispatch。ownProps的变化也会触发mapDispatchToProps。</p>
<p><strong>mergeProps(stateProps, dispatchProps, ownProps)：</strong></p>
<blockquote>
<p>将mapStateToProps() 与 mapDispatchToProps()返回的对象和组件自身的props合并成新的props并传入组件。默认返回 Object.assign({}, ownProps, stateProps, dispatchProps) 的结果。</p>
</blockquote>
<p><strong>options：</strong></p>
<blockquote>
<p>pure = true 表示Connect容器组件将在shouldComponentUpdate中对store的state和ownProps进行浅对比，判断是否发生变化，优化性能。为false则不对比。</p>
</blockquote>
<p>其实connect函数并没有做什么，大部分的逻辑都是在它返回的wrapWithConnect函数内实现的，确切的说是在wrapWithConnect内定义的Connect组件里实现的。</p>
<h3 id="下面是一个完整的-react-–-gt-redux-–-gt-react-流程："><a href="#下面是一个完整的-react-–-gt-redux-–-gt-react-流程：" class="headerlink" title="下面是一个完整的 react –&gt; redux –&gt; react 流程："></a>下面是一个完整的 react –&gt; redux –&gt; react 流程：</h3><p>一、Provider组件接受redux的store作为props，然后通过context往下传。</p>
<p>二、connect函数在初始化的时候会将mapDispatchToProps对象绑定到store，如果mapDispatchToProps是函数则在Connect组件获得store后，根据传入的store.dispatch和action通过bindActionCreators进行绑定，再将返回的对象绑定到store，connect函数会返回一个wrapWithConnect函数，同时wrapWithConnect会被调用且传入一个ui组件，wrapWithConnect内部使用class Connect extends Component定义了一个Connect组件，传入的ui组件就是Connect的子组件，然后Connect组件会通过context获得store，并通过store.getState获得完整的state对象，将state传入mapStateToProps返回stateProps对象、mapDispatchToProps对象或mapDispatchToProps函数会返回一个dispatchProps对象，stateProps、dispatchProps以及Connect组件的props三者通过Object.assign()，或者mergeProps合并为props传入ui组件。然后在ComponentDidMount中调用store.subscribe，注册了一个回调函数handleChange监听state的变化。</p>
<p>三、此时ui组件就可以在props中找到actionCreator，当我们调用actionCreator时会自动调用dispatch，在dispatch中会调用getState获取整个state，同时注册一个listener监听state的变化，store将获得的state和action传给combineReducers，combineReducers会将state依据state的key值分别传给子reducer，并将action传给全部子reducer，reducer会被依次执行进行action.type的判断，如果有则返回一个新的state，如果没有则返回默认。combineReducers再次将子reducer返回的单个state进行合并成一个新的完整的state。此时state发生了变化。dispatch在state返回新的值之后会调用所有注册的listener函数其中包括handleChange函数，handleChange函数内部首先调用getState获取新的state值并对新旧两个state进行浅对比，如果相同直接return，如果不同则调用mapStateToProps获取stateProps并将新旧两个stateProps进行浅对比，如果相同，直接return结束，不进行后续操作。如果不相同则调用this.setState()触发Connect组件的更新，传入ui组件，触发ui组件的更新，此时ui组件获得新的props，react –&gt; redux –&gt; react 的一次流程结束。</p>
<p><strong>上面的有点复杂，简化版的流程是：</strong></p>
<p>一、Provider组件接受redux的store作为props，然后通过context往下传。</p>
<p>二、connect函数收到Provider传出的store，然后接受三个参数mapStateToProps，mapDispatchToProps和组件，并将state和actionCreator以props传入组件，这时组件就可以调用actionCreator函数来触发reducer函数返回新的state，connect监听到state变化调用setState更新组件并将新的state传入组件。</p>
<p>connect可以写的非常简洁，mapStateToProps，mapDispatchToProps只不过是传入的回调函数，connect函数在必要的时候会调用它们，名字不是固定的，甚至可以不写名字。</p>
<p>简化版本：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">connect(state =&gt; state, action)(Component);</div></pre></td></tr></table></figure></p>
<h2 id="项目搭建"><a href="#项目搭建" class="headerlink" title="项目搭建"></a>项目搭建</h2><p>上面说了react，react-router和redux的知识点。但是怎么样将它们整合起来，搭建一个完整的项目。</p>
<p>1、先引用 react.js，redux，react-router 等基本文件，建议用npm安装，直接在文件中引用。</p>
<p>2、从 react.js，redux，react-router 中引入所需要的对象和方法。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123;Component, PropTypes&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> ReactDOM, &#123;render&#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123;Provider, connect&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123;createStore, combineReducers, applyMiddleware&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Router, Route, Redirect, IndexRoute, browserHistory, hashHistory &#125; <span class="keyword">from</span> <span class="string">'react-router'</span>;</div></pre></td></tr></table></figure></p>
<p>3、根据需求创建顶层ui组件，每个顶层ui组件对应一个页面。</p>
<p>4、创建actionCreators和reducers，并用combineReducers将所有的reducer合并成一个大的reduer。利用createStore创建store并引入combineReducers和applyMiddleware。</p>
<p>5、利用connect将actionCreator，reuder和顶层的ui组件进行关联并返回一个新的组件。</p>
<p>6、利用connect返回的新的组件配合react-router进行路由的部署，返回一个路由组件Router。</p>
<p>7、将Router放入最顶层组件Provider，引入store作为Provider的属性。</p>
<p>8、调用render渲染Provider组件且放入页面的标签中。</p>
<p>可以看到顶层的ui组件其实被套了四层组件，Provider，Router，Route，Connect，这四个组件并不会在视图上改变react，它们只是功能性的。</p>
<p>通常我们在顶层的ui组件打印props时可以看到一堆属性：</p>
<p><img src="https://github.com/bailicangdu/pxq/blob/master/src/images/react_props.png" alt=""></p>
<p>上图的顶层ui组件属性总共有18个，如果刚刚接触react，可能对这些属性怎么来的感到困惑，其实这些属性来自五个地方：</p>
<p>组件自定义属性1个，actionCreator返回的对象6个，reducer返回的state4个，Connect组件属性0个，以及Router注入的属性7个。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://RamboLu.top/2016/12/08/ReactNative学习-MAC集成环境/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RamboLu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/钢铁侠.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RamboLu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/08/ReactNative学习-MAC集成环境/" itemprop="url">
                  ReactNative学习-MAC集成环境
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-08T23:29:01+08:00">
                2016-12-08
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/12/08/ReactNative学习-MAC集成环境/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/08/ReactNative学习-MAC集成环境/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/12/08/ReactNative学习-MAC集成环境/" class="leancloud_visitors" data-flag-title="ReactNative学习-MAC集成环境">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>官网有更详细的集成步骤，这里只是根据个人需求写出简单实用的集成步骤。</p>
</blockquote>
<h2 id="1-配置环境"><a href="#1-配置环境" class="headerlink" title="1.配置环境"></a>1.配置环境</h2><h4 id="按照HomeBrew"><a href="#按照HomeBrew" class="headerlink" title="按照HomeBrew"></a>按照HomeBrew</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</div></pre></td></tr></table></figure>
<h4 id="安装Node-js"><a href="#安装Node-js" class="headerlink" title="安装Node.js"></a>安装Node.js</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install node</div></pre></td></tr></table></figure>
<h4 id="替换npm仓库镜像源"><a href="#替换npm仓库镜像源" class="headerlink" title="替换npm仓库镜像源"></a>替换npm仓库镜像源</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">npm config set registry https://registry.npm.taobao.org --global</div><div class="line"></div><div class="line">npm config set disturl https://npm.taobao.org/dist --global</div></pre></td></tr></table></figure>
<h4 id="安装Watchman"><a href="#安装Watchman" class="headerlink" title="安装Watchman"></a>安装Watchman</h4><p>Watchman是由Facebook提供的监视文件系统变更的工具。安装此工具可以提高开发时的性能</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install watchman</div></pre></td></tr></table></figure>
<h2 id="2-安装工具包"><a href="#2-安装工具包" class="headerlink" title="2.安装工具包"></a>2.安装工具包</h2><h4 id="安装RN命令行工具包"><a href="#安装RN命令行工具包" class="headerlink" title="安装RN命令行工具包"></a>安装RN命令行工具包</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g yarn react-native-cli</div></pre></td></tr></table></figure>
<p>遇到<strong>EACCES: permission denied</strong>权限报错，需要修复/usr/local目录的所有权：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chown -R `whoami` /usr/local</div></pre></td></tr></table></figure>
<h2 id="3-创建React-Native测试项目"><a href="#3-创建React-Native测试项目" class="headerlink" title="3.创建React Native测试项目"></a>3.创建React Native测试项目</h2><p>主要是需要 <strong>cd</strong> 到对应文件目录，再init， <strong>”testProject“</strong> 名字是自定义的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native init testProject</div></pre></td></tr></table></figure>
<h4 id="如果报错-无法创建-尝试使用使用下面的命令更新brew及对应的工具"><a href="#如果报错-无法创建-尝试使用使用下面的命令更新brew及对应的工具" class="headerlink" title="如果报错, 无法创建. 尝试使用使用下面的命令更新brew及对应的工具"></a>如果报错, 无法创建. 尝试使用使用下面的命令更新brew及对应的工具</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">brew update</div><div class="line"></div><div class="line">brew upgrade</div></pre></td></tr></table></figure>
<h4 id="打开项目-找到iOS文件夹中的工程文件运行即可"><a href="#打开项目-找到iOS文件夹中的工程文件运行即可" class="headerlink" title="打开项目, 找到iOS文件夹中的工程文件运行即可"></a>打开项目, 找到iOS文件夹中的工程文件运行即可</h4>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://RamboLu.top/2016/10/15/Swift学习-Swift3-0已出坑，适配iOS10-项目迁移Swift3-0问题总结。/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RamboLu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/钢铁侠.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RamboLu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/15/Swift学习-Swift3-0已出坑，适配iOS10-项目迁移Swift3-0问题总结。/" itemprop="url">
                  Swift学习-Swift3.0已出坑，适配iOS10,项目迁移Swift3.0问题总结。
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-15T00:23:31+08:00">
                2016-10-15
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/10/15/Swift学习-Swift3-0已出坑，适配iOS10-项目迁移Swift3-0问题总结。/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/15/Swift学习-Swift3-0已出坑，适配iOS10-项目迁移Swift3-0问题总结。/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/10/15/Swift学习-Swift3-0已出坑，适配iOS10-项目迁移Swift3-0问题总结。/" class="leancloud_visitors" data-flag-title="Swift学习-Swift3.0已出坑，适配iOS10,项目迁移Swift3.0问题总结。">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><blockquote>
<p>Swift项目,为适配iOS10,无奈只能更新Xcode 8 ,可是发现一入3.0深似海,从此幸福是路人.于是边摸索边修改,在节前的完成代码迁移.节后在完成手头工作后,整理思路,把Swift3.0迁移的心得分享大家.<br>废话不多说分享下心得:</p>
</blockquote>
<h2 id="1、代码篇-一定要做好备份"><a href="#1、代码篇-一定要做好备份" class="headerlink" title="1、代码篇:(一定要做好备份!!!)"></a>1、代码篇:(一定要做好备份!!!)</h2><hr>
<h4 id="1-gt-升级Xcode8正式版-8A218a"><a href="#1-gt-升级Xcode8正式版-8A218a" class="headerlink" title="1&gt;升级Xcode8正式版(8A218a)."></a>1&gt;升级Xcode8正式版(8A218a).</h4><p><img src="http://upload-images.jianshu.io/upload_images/1666327-98d84a6ab3a12740.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Xcode 8 "></p>
<h4 id="2-gt-使用系统自带的桥接工具-原装的就是好-直接打开2-2项目也会提醒-gt-步骤-3"><a href="#2-gt-使用系统自带的桥接工具-原装的就是好-直接打开2-2项目也会提醒-gt-步骤-3" class="headerlink" title="2&gt;使用系统自带的桥接工具.(原装的就是好,直接打开2.2项目也会提醒-&gt;步骤:3)"></a>2&gt;使用系统自带的桥接工具.(原装的就是好,直接打开2.2项目也会提醒-&gt;步骤:3)</h4><h6 id="Edit-gt-Convert-gt-To-Current-Swift-Syntax"><a href="#Edit-gt-Convert-gt-To-Current-Swift-Syntax" class="headerlink" title="Edit &gt; Convert &gt; To Current Swift Syntax.."></a>Edit &gt; Convert &gt; To Current Swift Syntax..</h6><p><img src="http://upload-images.jianshu.io/upload_images/1666327-fec7c1aada9529b8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="桥接选项"></p>
<h4 id="3-gt-不用说就是为3-0来的-选择Swift3"><a href="#3-gt-不用说就是为3-0来的-选择Swift3" class="headerlink" title="3&gt;不用说就是为3.0来的,选择Swift3."></a>3&gt;不用说就是为3.0来的,选择Swift3.</h4><p><img src="http://upload-images.jianshu.io/upload_images/1666327-84d13f5bf197baa0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Swift3.0"></p>
<h4 id="4-gt-上面的框架就不用选了-只选择-app的-这个是检测代码-不然你会哭的"><a href="#4-gt-上面的框架就不用选了-只选择-app的-这个是检测代码-不然你会哭的" class="headerlink" title="4&gt;上面的框架就不用选了,只选择.app的.(这个是检测代码,不然你会哭的)"></a>4&gt;上面的框架就不用选了,只选择<code>.app</code>的.(这个是检测代码,不然你会哭的)</h4><p><img src="http://upload-images.jianshu.io/upload_images/1666327-4e3fc24ecf949ac7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=".app"></p>
<h4 id="5-gt-检测完后"><a href="#5-gt-检测完后" class="headerlink" title="5&gt;检测完后."></a>5&gt;检测完后.</h4><p>在左边的选择页中选择好要转移的代码,左边的代码是Swift3.0代码,右侧代码时swift2.2代码-&gt;点<code>Save</code>.<br><img src="http://upload-images.jianshu.io/upload_images/1666327-bea954aa25e31670.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="6.png"></p>
<h2 id="2、第三方框架篇-使用的cocoapods管理的第三方框架"><a href="#2、第三方框架篇-使用的cocoapods管理的第三方框架" class="headerlink" title="2、第三方框架篇:(使用的cocoapods管理的第三方框架)"></a>2、第三方框架篇:(使用的cocoapods管理的第三方框架)</h2><hr>
<h4 id="1-gt-发现框架报错-不要怕-按照错误一样一样来"><a href="#1-gt-发现框架报错-不要怕-按照错误一样一样来" class="headerlink" title="1&gt;发现框架报错.(不要怕,按照错误一样一样来)"></a>1&gt;发现框架报错.(不要怕,按照错误一样一样来)</h4><h5 id="问题1-–-第三方框架版本问题-”Use-Legacy-Swift-Language-Version”"><a href="#问题1-–-第三方框架版本问题-”Use-Legacy-Swift-Language-Version”" class="headerlink" title="* 问题1:–.第三方框架版本问题,”Use Legacy Swift Language Version”"></a>* 问题1:–.第三方框架版本问题,”Use Legacy Swift Language Version”</h5><p>“Use Legacy Swift Language Version” (SWIFT_VERSION) is required to be configured correctly for targets which use Swift. Use the [Edit &gt; Convert &gt; To Current Swift Syntax…] menu to choose a Swift version or use the Build Settings editor to configure the build setting directly.<br><img src="http://upload-images.jianshu.io/upload_images/1666327-3146e35e3b1dff2f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="第三方框架版本问题"><br>在pod的配置文件里面的Use Legacy Swift Language Version选择<code>YES</code>错误就消除了<br><code>Pods</code>-&gt;<code>TARGETS-&gt;指定框架</code> -&gt; <code>Build Settings</code> -&gt; <code>Use Legacy Swift Language Version</code><br><img src="http://upload-images.jianshu.io/upload_images/1666327-ced879460f44ea3c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="pod的配置"></p>
<h5 id="问题2-–-lipo-can’t-open-input-file-xxx-No-such-file-or-directory"><a href="#问题2-–-lipo-can’t-open-input-file-xxx-No-such-file-or-directory" class="headerlink" title="* 问题2:–.lipo:can’t open input file:xxx(No such file or directory)"></a>* 问题2:–.lipo:can’t open input file:xxx(No such file or directory)</h5><p><img src="http://upload-images.jianshu.io/upload_images/1666327-bb07e2570e751087.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="lipo:"></p>
<p><code>PROJRCT</code>-&gt; <code>Build Settings</code> -&gt; <code>Build Active Architecture only</code>-&gt;<code>YES</code></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-9bc9b5e892190e90.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="lipo"><br>其他问题后续收集再整理…</p>
<h4 id="2-gt-发现框架过时-需要更新框架"><a href="#2-gt-发现框架过时-需要更新框架" class="headerlink" title="2&gt;发现框架过时,需要更新框架."></a>2&gt;发现框架过时,需要更新框架.</h4><p>由于3.0的更新,Swift各个主流框架都已经及时的推出了新的版本,例如:Alamofire 4.0.0 , SnapKit 3.0.0 , Kingfisher 3.1.0 , SwiftyJSON 也已经更新了专供Swift3的分支.<br>所以,要更新框架以供使用.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-d67e896f28e9c548.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="更新主流第三方框架"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pod &apos;SnapKit&apos;, &apos;~&gt; 3.0.0&apos;</div><div class="line">pod &apos;SwiftyJSON&apos;, :git =&gt; &apos;https://github.com/acegreen/SwiftyJSON.git&apos;, :branch =&gt; &apos;swift3&apos;</div><div class="line">pod &apos;Alamofire&apos;,&apos;~&gt; 4.0.0&apos;</div><div class="line">pod &apos;Kingfisher&apos;,&apos;~&gt; 3.1.0&apos;</div></pre></td></tr></table></figure>
<p>可能会出现以下问题:</p>
<h6 id="SnapKit框架问题"><a href="#SnapKit框架问题" class="headerlink" title="* SnapKit框架问题:"></a>* SnapKit框架问题:</h6><p><img src="http://upload-images.jianshu.io/upload_images/1666327-b66d211f0bbcc0f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SnapKit"></p>
<p>看到200多个框架错误后凌乱了.都是3.0语法了,为什么还会报错,不在框架,在自己安装的cocoapods环境有关系.</p>
<p>解决方案:<br>需要更新最新环境到<code>cocoapods 1.1.0.rc.2</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install cocoapods --pre</div></pre></td></tr></table></figure>
<p>可以参照SnapKit的官方issues:<br><a href="https://github.com/SnapKit/SnapKit/issues/300" target="_blank" rel="external">https://github.com/SnapKit/SnapKit/issues/300</a><br>如果没有安装 cocoapods可以参照之前写的博客.<br><a href="http://www.jianshu.com/p/b98b8ac7d22d" target="_blank" rel="external">安装 cocoapods 1.1.0心得体会:</a></p>
<h6 id="Alamofire框架问题"><a href="#Alamofire框架问题" class="headerlink" title="* Alamofire框架问题:"></a>* Alamofire框架问题:</h6><p><img src="http://upload-images.jianshu.io/upload_images/1666327-14c391721f02140b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Alamofire"></p>
<p>Alamofire/Source/ServerTrustPolicy.swift:243:41: Use of unresolved identifier ‘kSecTrustResultInvalid’</p>
<p>Alamofire的官方issues:<br><a href="https://github.com/Alamofire/Alamofire/issues/1541" target="_blank" rel="external">https://github.com/Alamofire/Alamofire/issues/1541</a></p>
<p>解决方案:<br>上面也提到了,更新最新的Alamofire框架.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod &apos;Alamofire&apos;,&apos;~&gt; 4.0.0&apos;</div></pre></td></tr></table></figure>
<p>可能还遇到的问题:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[!] Unable to satisfy the following requirements:</div><div class="line"></div><div class="line">- `Alamofire (~&gt; 4.0.0)` required by `Podfile`</div><div class="line"></div><div class="line">Specs satisfying the `Alamofire (~&gt; 4.0.0)` dependency were found, but they required a higher minimum deployment target.</div></pre></td></tr></table></figure>
<p>解决方法:<br>Alamofire 4.0.0 最低要求系统版本9.0,已经将系统升高到9.0还是无法安装.<br>目前的没有找到有效的解决方法,只有一个方案就是重新立项先集成框架,在把转接完的代码迁移到新的项目中去.</p>
<hr>
<p>10月24日,更新解决方法.<br>之前提示Alamofire 4.0.0, Podfile报错.<br>需要在Podfile文件中指定最低系统9.0项目版本.<code>platform :ios,&#39;9.0&#39;</code><br>Alamofire的官方issues:<br><a href="https://github.com/Alamofire/Alamofire/issues/1639" target="_blank" rel="external">https://github.com/Alamofire/Alamofire/issues/1639</a><br><img src="http://upload-images.jianshu.io/upload_images/1666327-2638ba907c545a40.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="指定9.0"></p>
<hr>
<h6 id="可能还会有其他框架问题-目前还没有遇到-欢迎讨论"><a href="#可能还会有其他框架问题-目前还没有遇到-欢迎讨论" class="headerlink" title="* 可能还会有其他框架问题,目前还没有遇到.欢迎讨论."></a>* 可能还会有其他框架问题,目前还没有遇到.欢迎讨论.</h6><h2 id="3-其他问题总结"><a href="#3-其他问题总结" class="headerlink" title="3.其他问题总结:"></a>3.其他问题总结:</h2><hr>
<h6 id="关于重建工程来迁移到Swift3-0解决方案"><a href="#关于重建工程来迁移到Swift3-0解决方案" class="headerlink" title="* 关于重建工程来迁移到Swift3.0解决方案."></a>* 关于重建工程来迁移到Swift3.0解决方案.</h6><p>前面也提到了,发现有个别问题无法解决,一直解决也是没有成效,于是使用目前来说最简洁的方法就重新建立工程.</p>
<p>先把新建的工程集成好最新支持Swift3.0的第三方框架,测试程序可不可以跑通后,再把之前转换完的代码一个分类一个分类迁移到新的工程里面.</p>
<p>至于手工拖入的第三方依赖库,应用跳转,按照之前集成好的照搬.或者重新集成.</p>
<h6 id="Swift3-0语法的学习"><a href="#Swift3-0语法的学习" class="headerlink" title="* Swift3.0语法的学习."></a>* Swift3.0语法的学习.</h6><p>1.官方已经给出文档以及转变说明.<br>Apple Swift 3.0官方文档:<a href="https://developer.apple.com/library/prerelease/content/documentation/Swift/Conceptual/Swift_Programming_Language/TheBasics.html#//apple_ref/doc/uid/TP40014097-CH5-ID309" target="_blank" rel="external">The Swift Programming Language (Swift 3)</a></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-0b6b3aaf1d67bed3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Apple Swift 3.0官方文档"></p>
<p>2.Apple  Swift 3.0官方演变:<a href="https://github.com/apple/swift-evolution/blob/master/releases/swift-3_0.md" target="_blank" rel="external">apple/swift-evolution/releases/swift-3_0.md</a></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-0e3bcf5083b6d4e0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Swift 3.0官方演变"><br>其主要是废除了一些API,简化代码的书写,例如取出OC中的NS类前缀,C语言的风格,等等.</p>
<p>3.国外raywenderlich的Swift 3.0迁移介绍:<br><a href="https://www.raywenderlich.com/135655/whats-new-swift-3" target="_blank" rel="external">https://www.raywenderlich.com/135655/whats-new-swift-3</a></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-0cb70ac2167f7a10.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="raywenderlich的Swift 3.0"></p>
<h6 id="后续持续补充"><a href="#后续持续补充" class="headerlink" title="* 后续持续补充."></a>* 后续持续补充.</h6><h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><ul>
<li>对Swift3的书写方式还需要进一步的加强,虽然和之前的写法有着轻微的改动,使整体变的更加的简洁、严谨,但是稍不注意还是出现莫名其妙的报错.</li>
<li>展望Swift4,让暴风雨来的更猛烈些吧.</li>
<li>欢迎讨论、批评、指正.</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://RamboLu.top/2016/10/10/Cocoapods进阶-屡试不爽，安装Cocoapods1.1.0最新心得及问题总结!/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RamboLu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/钢铁侠.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RamboLu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/10/Cocoapods进阶-屡试不爽，安装Cocoapods1.1.0最新心得及问题总结!/" itemprop="url">
                  Cocoapods进阶-屡试不爽，安装Cocoapods1.1.0最新心得及问题总结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-10T18:20:25+08:00">
                2016-10-10
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/10/10/Cocoapods进阶-屡试不爽，安装Cocoapods1.1.0最新心得及问题总结!/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/10/Cocoapods进阶-屡试不爽，安装Cocoapods1.1.0最新心得及问题总结!/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/10/10/Cocoapods进阶-屡试不爽，安装Cocoapods1.1.0最新心得及问题总结!/" class="leancloud_visitors" data-flag-title="Cocoapods进阶-屡试不爽，安装Cocoapods1.1.0最新心得及问题总结">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>安装淘宝源就直接跳过,安装十余次,分享下最近安装cocoapods的经验,仅仅提醒ruby版本问题之后的操作.如果还有不懂地方可以下方评论,会及时回答.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Error installing cocoapods:</div><div class="line">	activesupport requires Ruby version &gt;= 2.2.2.</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="1-安装ruby"><a href="#1-安装ruby" class="headerlink" title="1.安装ruby"></a>1.安装ruby</h3><h5 id="1-gt-安装-RVM"><a href="#1-gt-安装-RVM" class="headerlink" title="1&gt;安装 RVM"></a>1&gt;安装 RVM</h5><p>RVM: Ruby Version Manager, Ruby的版本管理器，包括Ruby的版本管理和Gem库管理(gemset)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -L get.rvm.io | bash -s stable</div></pre></td></tr></table></figure></p>
<h5 id="2-gt-安装home-brew-切记先安装home-brew-再安装ruby"><a href="#2-gt-安装home-brew-切记先安装home-brew-再安装ruby" class="headerlink" title="2&gt;安装home-brew(切记先安装home-brew,再安装ruby!!)"></a>2&gt;安装home-brew(切记先安装home-brew,再安装ruby!!)</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-6909f2a40a341691.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Homebrew"><br><a href="http://brew.sh" target="_blank" rel="external">home-brew地址:</a>&lt;–</p>
<p>如果出现重复安装home-brew,不要怕.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-775c733738fa3fdc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="重复安装home-brew"><br>会给你提示命令.<br>It appears Homebrew is already installed. If your intent is to reinstall you<br>should do the following before running this installer again:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/uninstall)&quot;</div></pre></td></tr></table></figure></p>
<h5 id="3-gt-再安装ruby版本-最新版本2-3-0"><a href="#3-gt-再安装ruby版本-最新版本2-3-0" class="headerlink" title="3&gt;再安装ruby版本(最新版本2.3.0)"></a>3&gt;再安装ruby版本(最新版本2.3.0)</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rvm install 2.3.0</div></pre></td></tr></table></figure>
<p>出现情况:<br>1.安装不通过的话可以进行手动安装.<br><img src="http://upload-images.jianshu.io/upload_images/1666327-45656448ed643a15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="手动安装"></p>
<blockquote>
<p>Installing requirements for osx.<br>Updating system…..<br>Installing required packages: autoconf, automake, libtool, pkg-config, libyaml, readline, libksba, openssl|<br>……..<br>Error running ‘requirements_osx_brew_libs_install autoconf automake libtool pkg-config libyaml readline libksba openssl’,<br>showing last 15 lines of /Users/MTKJ/.rvm/log/1469285314_ruby-2.3.0/package_install_autoconf_automake_libtool_pkg-config_libyaml_readline_libksba_openssl.log</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">brew install autoconf</div><div class="line">brew install automake</div><div class="line">brew install lib tool</div><div class="line">brew install apple-gcc42</div><div class="line">brew install libyaml</div><div class="line">brew install libxslt</div><div class="line">brew install libksba</div><div class="line">brew install openssl</div></pre></td></tr></table></figure>
<p>2 . Error running ‘__rvm_make -j 1’ 错误</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-4fa021187046f2d3.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="running &#39;__rvm_make -j 1&#39;"></p>
<blockquote>
<p>ruby-2.3.0 - #extracting ruby-2.3.0 to /Users/xxxx/.rvm/src/ruby-2.3.0…-<br>ruby-2.3.0 - #configuring………………………………………………|<br>ruby-2.3.0 - #post-configuration.<br>ruby-2.3.0 - #compiling………..<br>Error running ‘__rvm_make -j 1’,<br>showing last 15 lines of /Users/xxxx/.rvm/log/1476689284_ruby-2.3.0/make.log<br>compiling dln.c<br>compiling localeinit.c<br>creating verconf.h<br>verconf.h updated<br>compiling loadpath.c<br>compiling prelude.c<br>linking static-library libruby.2.3.0-static.a<br>verifying static-library libruby.2.3.0-static.a<br>linking shared-library libruby.2.3.0.dylib<br>generating encdb.h<br>encdb.h updated<br>making enc<br>/bin/sh: /Applications/Xcode: No such file or directory<br>make: <em>*</em> [enc] Error 127<br>++ return 2<br>There has been an error while running make. Halting the installation.<br>/Users/xxxx/.rvm/bin/rvm: line 66: shell_session_update: command not found</p>
</blockquote>
<ul>
<li>安装xcode command line 后再次安装ruby.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xcode-select --install</div></pre></td></tr></table></figure>
<ul>
<li>如果还是没有成功,查看自己xcode command line 是否选在正确版本.</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-b9ed79eaa12daa63.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Command Line Tools"></p>
<h5 id="4-gt-出现错误了-还是没有安装成功ruby-没关系-卸载RVM-从新安装"><a href="#4-gt-出现错误了-还是没有安装成功ruby-没关系-卸载RVM-从新安装" class="headerlink" title="4&gt;出现错误了,还是没有安装成功ruby.(没关系,卸载RVM,从新安装!)"></a>4&gt;出现错误了,还是没有安装成功ruby.(没关系,卸载RVM,从新安装!)</h5><p>要记得关闭终端重新打开, 或者打开路径<code>cd ~</code>出现在<code>~</code></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1666327-801a78332b5d3df5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="~"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo rm -rf .rvm .rvmrc   /etc/rvmrc ;gem uninstall rvm</div></pre></td></tr></table></figure>
<h3 id="2-安装CocoaPods"><a href="#2-安装CocoaPods" class="headerlink" title="2.安装CocoaPods"></a>2.安装CocoaPods</h3><h5 id="1-gt-安装cocoapods-普通版本"><a href="#1-gt-安装cocoapods-普通版本" class="headerlink" title="1&gt;安装cocoapods(普通版本)"></a>1&gt;安装cocoapods(普通版本)</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install cocoapods</div></pre></td></tr></table></figure>
<h5 id="2-gt-更新框架库"><a href="#2-gt-更新框架库" class="headerlink" title="2&gt;更新框架库"></a>2&gt;更新框架库</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod setup</div></pre></td></tr></table></figure>
<p>可以查看框架镜像库的<code>cd   ~/.cocoapods</code></p>
<h5 id="3-gt-更新cocoapods版本-测试版本-仅供特定条件"><a href="#3-gt-更新cocoapods版本-测试版本-仅供特定条件" class="headerlink" title="3&gt;更新cocoapods版本(测试版本,仅供特定条件)"></a>3&gt;更新cocoapods版本(测试版本,仅供特定条件)</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install cocoapods --pre</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://RamboLu.top/2016/07/01/WKWebView替换UIWebView/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RamboLu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/钢铁侠.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RamboLu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/01/WKWebView替换UIWebView/" itemprop="url">
                  WKWebView替换UIWebView
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-07-01T18:42:07+08:00">
                2016-07-01
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/07/01/WKWebView替换UIWebView/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/01/WKWebView替换UIWebView/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/07/01/WKWebView替换UIWebView/" class="leancloud_visitors" data-flag-title="WKWebView替换UIWebView">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>目前,WKWebView只在iOS8后才能用,但是大多数App需要支持iOS7以上的版本，所以兼容性方案就是,iOS7下用UIWebView，iOS8后WKWebView.</p>
</blockquote>
<h2 id="一、"><a href="#一、" class="headerlink" title="一、"></a>一、</h2>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>


          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/img/钢铁侠.png"
               alt="RamboLu" />
          <p class="site-author-name" itemprop="name">RamboLu</p>
           
              <p class="site-description motion-element" itemprop="description">Fire proves gold,adversity proves men.</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/RamboLouis" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/210008553" target="_blank" title="新浪微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  新浪微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.jianshu.com/users/7ebaa8152f09" target="_blank" title="简书">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  简书
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/RamboLouis" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://objccn.io/" title="ObjC中国" target="_blank">ObjC中国</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://hexo.io" title="Hexo" target="_blank">Hexo</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://pages.github.com/" title="GitHub" target="_blank">GitHub</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://stackoverflow.com" title="Stack Overflow" target="_blank">Stack Overflow</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.raywenderlich.com" title="Ray Wenderlich" target="_blank">Ray Wenderlich</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://cn.udacity.com/" title="Udacity" target="_blank">Udacity</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RamboLu</span>
</div>


<div class="powered-by">
   <a class="theme-link" href="https://hexo.io">Hexo</a> 
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"rambolu"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  













  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("UpN97PCxY6PrIMk3Gvgr7oxp-gzGzoHsz", "rgnJBaCPX4E4G0oXvw19elko");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


  

</body>
</html>
